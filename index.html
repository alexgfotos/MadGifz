<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!--Bulma-->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.8.0/css/bulma.min.css">
    <script defer src="https://use.fontawesome.com/releases/v5.3.1/js/all.js"></script>

    <title>MadGIPHZ</title>
</head>

<body>
    <section class="hero is-primary">
        <div class="hero-body">
            <div class="container">
                <h1 class="title">
                    MadGIPHZ
                </h1>
                <h2 class="subtitle">
                    add something clever
                </h2>
                <br>
            </div>
        </div>
    </section>
    <nav class="navbar" role="navigation" aria-label="main navigation">
        <div class="navbar-brand">
            <a class="navbar-item" href="">
                <h2>Your Libray</h2>
            </a>
            <div class="navbar-brand">
                <a class="navbar-item" href="">
                    <h2>Global Libray</h2>
                </a>
    </nav>
    <div id= "user-input" class="container">
        <div class="box">
            <article class="media">
                <div class="media-left">
                    <figure class="image is-64x64">
                        <img src="https://bulma.io/images/placeholders/128x128.png" alt="Image">
                    </figure>
                </div>
                <div id= "input-box" class="media-content">
                    <div class="content">


                        <p>
                            <strong>Let's Play!</strong> 
                            
                        </p>
                    </div>
                    <input id= "blank" class="input is-rounded" type="text" placeholder="Rounded input">

                    <button id= "next-button" class="button  is-warning">Next</button>
                    <nav class="level is-mobile">


                        </span>
                        </a>
                </div>

        </div>
        </article>
        <p id= "fill-blank"></p>
    </div>
    </div>
    </a>
    </div>
    </nav>

    


    
    

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <script type="text/javascript">

    var madlibz; 
    var count = 0;
    function startGame(){
        count = 0;
    }

    // Event listener for our cat-button
    $("#next-button").on("click", function() {

        var blank = $("#blank").val().trim();
        var queryURL = "https://api.giphy.com/v1/gifs/random?api_key=mAZatgWo6T9hgzFNKRIFDeLp5AIdXStq&tag=" + blank ;

        if (count > madlibz.blanks.length){
            $("#next-button").hide();
            var finishButton = $("<button>");
            finishButton.text("Finish!");
            finishButton.attr("class", "button");
            $("#input-box").append(finishButton);

            finishButton.on("click" , function(){
                generate();
            })


    
        }

        $("#blank").attr("placeholder", madlibz.blanks[count])



      // Perfoming an AJAX GET request to our queryURL
        $.ajax({
            url: queryURL,
            method: "GET"
        })


        // After the data from the AJAX request comes back
            .then(function(response) {

            
            // Saving the image_original_url property
            var imageUrl = response.data.image_original_url;
            console.log(imageUrl);

            localStorage.setItem(count, imageUrl);
            
          
            // Creating and storing an image tag
            var gif = $("<img>");

            // // Setting the gif src attribute to imageUrl
            gif.attr("src", imageUrl);
            gif.attr("alt", "cat image");

            // // Prepending the gif to the images div
            $("#fill-blank").prepend(gif);
            });

            count++;
            
            // }
        });


    // madlibs AJAX
    

        var queryURL = "https://madlibz.herokuapp.com/api/random";

        // Perfoming an AJAX GET request to our queryURL
        $.ajax({
            url: queryURL,
            method: "GET"
        })
        .then(function(madlibzResponse) {
            madlibz = madlibzResponse
            console.log(madlibzResponse)

        // // Prepending the value and blanks to the html

            var blanksCount = 0;
            var valuesCount = 0;

            for(var i = 0; i < madlibzResponse.value.length + madlibzResponse.blanks.length; i++){

            if(i % 2 == 0){
                console.log(madlibzResponse.value[valuesCount]);
                valuesCount++
            } else if (i % 2 == 1 && blanksCount < madlibzResponse.blanks.length ){
                console.log(madlibzResponse.blanks[blanksCount]);
                blanksCount++
            }
            }
            // $("#fill-blank").append(response.value);
            // $("#fill-blank").append(response.blanks);
            
            $("#blank").attr("placeholder", madlibzResponse.blanks[0])
        
        });
        
        startGame()

    function generate(){
        $("#user-input").hide();
    }
  </script>


</body>

</html>